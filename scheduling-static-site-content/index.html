<!DOCTYPE html>
<html class="no-js">
<head>
	<meta charset="utf-8">
	
	<title>Schedule Blog Content for a Static Site | Technical Rex</title>
	<meta name="description" content="Static site generators are very appealing to designers and coders who want to blog. They're free, fast, secure, rich with plugins and themes, and the lack of...">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	<meta http-equiv="X-Frame-Options" content="sameorigin">

	<link rel="stylesheet" href="/css/main.css">

	<link rel="canonical" href="http://technicalrex.com/scheduling-static-site-content/">
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css">

	<!-- For IE 9 and below. ICO should be 32x32 pixels in size -->
<!--[if IE]><link rel="shortcut icon" href="/img/icons/favicon.ico"><![endif]-->

<!-- Touch Icons - iOS and Android 2.1+ 180x180 pixels in size. -->
<link rel="apple-touch-icon" href="/img/icons/apple-touch-icon.png">

<!-- Firefox, Chrome, Safari, IE 11+ and Opera. 196x196 pixels in size. -->
<link rel="icon" href="/img/icons/favicon.png">

	
<meta property="article:published_time" content="2016-03-17T00:00:00-04:00" />
<meta property="article:modified_time" content="2016-03-17T00:00:00-04:00" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Schedule Blog Content for a Static Site" />
<meta property="og:url" content="http://technicalrex.com/scheduling-static-site-content/" />
<meta property="og:description" content="Static site generators are very appealing to designers and coders who want to blog. They&#39;re free, fast, secure, rich with plugins and themes, and the lack of a database and little to no server-..." />
<meta property="og:site_name" content="Technical Rex" />
<meta property="og:locale" content="en_US" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@eriklgillespie" />
<meta name="twitter:creator" content="@eriklgillespie" />


</head>

<body>
  <div id="landscape">
    <header class="site-header">
	<div class="branding flow-nav">
		<h1 class="site-title">
			<a href="/">
				Technical Rex
			</a>
		</h1>
	</div>
	<nav class="site-nav flow-nav">
		<ul class="flow-nav">
			
			
			<li class="flow-nav">
				<a class="page-link" href="/about.html">About</a>
			</li>
			
			
			
			<li class="flow-nav">
				<a class="page-link" href="/apps.html">Apps</a>
			</li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<li class="flow-nav">
				<a href="/feed.xml" title="">
					<i class="fa fa-fw fa-rss"></i>
				</a>
			</li>
		</ul>
	</nav>
</header>

    <div id="page-container">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block;width:320px;height:50px"
     data-ad-client="ca-pub-5353438818816835"
     data-ad-slot="2993999908"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

      <div class="underlay">
    <div class="content">
        <article>
            <header class="post-header">
                <h1 class="title">Schedule Blog Content for a Static Site</h1>
                <p class="about">
                    Posted  by Erik Gillespie
                    on March 17, 2016
                </p>
            </header>
            <section class="post-content"><p>Static site generators can be very appealing to bloggers. They’re free, fast, secure, rich with plugins and themes, and the lack of a database and little to no server-side processing sheds a lot of the hassle associated with blogging. There are features common to dynamic sites (like WordPress) that you don’t get out of the box with a static site generator, though. One such feature is publishing content on a schedule.</p>

<h2 id="why-publish-on-a-schedule">Why Publish on a Schedule?</h2>

<p>The ability to schedule blog posts enables writing in batches. For my business, <a href="http://blog.givingjar.org" title="Giving Jar Blog">Giving Jar</a>, I write about and promote a different charity every other week. If I can spend one day interviewing and writing about two or three charities, it frees me from that task for four to six weeks!</p>

<p>Publishing articles at a specific time also make it easier to automate newsletters, social media posts, and other promotional material for the blog. Making your schedule well-known also encourages visitors to return to your site to look for new content.</p>

<h2 id="stay-near-your-comfort-zone">Stay Near Your Comfort Zone</h2>

<p>Once you find a solution for scheduling your static content, you probably won’t have to mess with it again. For that reason, I’m going to recommend doing something that I normally discourage: stay near your comfort zone. This isn’t the time to spend a lot of time learning a ton of new things if you have more important tasks to work on.</p>

<p>My comfort zone included <a href="http://jekyllrb.com/" title="Jekyll: A Free Static Site Generator">Jekyll</a> for the static site generator, <a href="https://surge.sh/" title="Surge.sh: A Free Static Site Host">Surge.sh</a> for free static site hosting, <a href="https://github.com/" title="GitHub: Amazing, Free Version Control">GitHub</a> for version control, <a href="http://gruntjs.com/" title="Grunt: A JavaScript-based Task Runner">Grunt</a> for building and deploying, and a Linux-based VM on <a href="https://www.digitalocean.com/" title="Digital Ocean: Cheap and Easy Virtual Machines">Digital Ocean</a> for scheduling code.</p>

<p>If you know Middleman, Gulp, or Windows, use them! Take the ideas from this article, adapt them, and save yourself some time (and probably a headache!). Perhaps even write about your alternative experience?</p>

<h2 id="assumptions">Assumptions</h2>

<p>Let’s assume you already have a blog created with Jekyll, you maintain your changes in GitHub, and you manually build the site, then deploy your changes at 9 AM every Wednesday to Surge.sh. Let’s also assume you are hosting your site at <code class="highlighter-rouge">my-site.com</code> and your GitHub repository is located at <code class="highlighter-rouge">https://github.com/my-user/my-site.com</code>.</p>

<p>The general steps to automating this process are to consolidate the build and deployment process to a single script, and then run that script somewhere that is “always on” at the desired time.</p>

<p>Another quick note about command syntax: commands should be typed exactly as they appear after the dollar sign ($). Any text before the $ is just a hint about which user should run the command. Any lines starting with a hashtag (#) are simply comments about what the subsequent commands do and should not be typed out.</p>

<h2 id="step-1-consolidate-your-deployment">Step 1: Consolidate Your Deployment</h2>

<p>At the end of this step, you should have a single command that you can run to checkout, build, and deploy your site.</p>

<p>Right now, the manual process looks like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">cd</span> ~/my-site.com
<span class="gp">$ </span>git fetch --all
<span class="gp">$ </span>git reset --hard origin/master
<span class="gp">$ </span>jekyll build
<span class="gp">$ </span>surge _site
</code></pre>
</div>

<p>If we use Grunt to perform these steps as a single command, we first must install <a href="https://www.npmjs.com/" title="NPM: Node Package Manager">NPM</a> (I recommend using <a href="https://github.com/creationix/nvm" title="NVM: Node Version Manager">NVM</a> to install NPM), then creating a <code class="highlighter-rouge">package.json</code> file to save development dependencies (such as Grunt), installing those dependencies, and finally, writing a <code class="highlighter-rouge">Gruntfile.js</code> file that Grunt will use to do our checkout, build, and deployment.</p>

<p>If you’re using Surge, you probably have NPM installed. As a refresher, installing NVM and NPM in Bash will look like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Install NVM</span>
<span class="gp">$ </span>touch ~/.bash_profile
<span class="gp">$ </span>curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash
<span class="gp">$ </span>. ~/.bash_profile

<span class="c"># Install NPM 4.3.1</span>
<span class="gp">$ </span>nvm install 4.3.1
<span class="gp">$ </span>nvm use 4.3.1
</code></pre>
</div>

<p>Next, create a <code class="highlighter-rouge">package.json</code> file at the base of your static site and add the dependencies we’ll need:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Change to your project directory</span>
<span class="gp">$ </span><span class="nb">cd</span> ~/my-site.com

<span class="c"># Create package.json</span>
<span class="gp">$ </span>npm init

<span class="c"># Install grunt</span>
<span class="gp">$ </span>npm install -g grunt

<span class="c"># Install dependencies</span>
<span class="gp">$ </span>npm install grunt --save-dev
<span class="gp">$ </span>npm install grunt-git --save-dev
<span class="gp">$ </span>npm install grunt-jekyll --save-dev
<span class="gp">$ </span>npm install grunt-surge --save-dev
</code></pre>
</div>

<p>You’ll have a <code class="highlighter-rouge">package.json</code> that looks something like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-site.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"homepage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://my-site.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MIT"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"test"</span><span class="p">:</span><span class="w"> </span><span class="s2">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"repository"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"git"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"git+https://github.com/my-user/my-site.com.git"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"grunt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~0.4.5"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"grunt-git"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.3.7"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"grunt-jekyll"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.4.3"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"grunt-surge"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.7.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The last step is to create a <code class="highlighter-rouge">Gruntfile.js</code> in the same directory as your <code class="highlighter-rouge">package.json</code> and add all of the checkout, build, and deployment steps. Start with this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grunt</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
    <span class="na">pkg</span><span class="p">:</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">readJSON</span><span class="p">(</span><span class="s1">'package.json'</span><span class="p">),</span>
    
    <span class="na">gitfetch</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">latest</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">all</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    
    <span class="na">gitreset</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">latest</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">mode</span><span class="p">:</span> <span class="s1">'hard'</span><span class="p">,</span>
          <span class="na">commit</span><span class="p">:</span> <span class="s1">'origin/master'</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
  
    <span class="na">jekyll</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">dist</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">serve</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="na">drafts</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="na">future</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="na">test</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">serve</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="na">drafts</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="na">future</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="na">surge</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">publish</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">project</span><span class="p">:</span> <span class="s1">'_site/'</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>
  
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">'grunt-git'</span><span class="p">);</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">'grunt-jekyll'</span><span class="p">);</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">'grunt-surge'</span><span class="p">);</span>
  
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'jekyll:dist'</span><span class="p">]);</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">'publish'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'gitfetch:latest'</span><span class="p">,</span> <span class="s1">'gitreset:latest'</span><span class="p">,</span> <span class="s1">'jekyll:dist'</span><span class="p">,</span> <span class="s1">'surge:publish'</span><span class="p">]);</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">'test'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'jekyll:test'</span><span class="p">]);</span>
<span class="p">};</span>
</code></pre>
</div>

<p>At this point the manual process has now been consolidated down to a single <code class="highlighter-rouge">grunt</code> command that will checkout, build, and deploy your site:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>grunt prod
</code></pre>
</div>

<p>This <code class="highlighter-rouge">Gruntfile.js</code> also allows you to run <code class="highlighter-rouge">grunt</code> to build your site without deploying it or <code class="highlighter-rouge">grunt test</code> to preview articles written for dates in the future or draft content.</p>

<p><strong>GOTCHA #1:</strong> <em>Running <code class="highlighter-rouge">grunt prod</code> works on your computer, but it won’t simply work like this when running from cron. That’s because cron runs scheduled commands in isolated environments and certain settings that typically come from your Bash profile and NVM won’t be accessible to cron commands. To get around this, create a shell script named <code class="highlighter-rouge">deploy.sh</code> at the root of your static site that will setup the environment before invoking Grunt.</em></p>

<p>Here’s what your <code class="highlighter-rouge">deploy.sh</code> might look like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

exit_usage<span class="o">()</span>
<span class="o">{</span>
  <span class="nb">echo</span> <span class="s2">"usage: </span><span class="nv">$0</span><span class="s2"> gruntfile_dir"</span>
  <span class="nb">exit </span>1
<span class="o">}</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"$#"</span> -ne 1 <span class="o">]</span>; <span class="k">then
  </span>exit_usage
<span class="k">fi</span>

. ~/.bash_profile

. ~/.nvm/nvm.sh
nvm use default

<span class="nb">cd</span> <span class="nv">$1</span>
grunt prod
</code></pre>
</div>

<p>Add <code class="highlighter-rouge">deploy.sh</code> to a list of files excluded from your static site when it is built. In Jekyll, add an “exclude” list to the end of your <code class="highlighter-rouge">_config.yml</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1"># Exclude files from generated site</span>
<span class="s">exclude</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">Gemfile</span>
  <span class="pi">-</span> <span class="s">Gemfile.lock</span>
  <span class="pi">-</span> <span class="s">LICENSE</span>
  <span class="pi">-</span> <span class="s">README.md</span>
  <span class="pi">-</span> <span class="s">package.json</span>
  <span class="pi">-</span> <span class="s">Gruntfile.js</span>
  <span class="pi">-</span> <span class="s">node_modules</span>
  <span class="pi">-</span> <span class="s">deploy.sh</span>
</code></pre>
</div>

<p>Also, make sure you mark <code class="highlighter-rouge">deploy.sh</code> as executable.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Set execute permission on deploy.sh</span>
<span class="gp">$ </span>chmod 755 deploy.sh
</code></pre>
</div>

<p>Don’t forget to add, commit, and push your changes to GitHub!</p>

<h2 id="step-2-setup-a-virtual-machine">Step 2: Setup a Virtual Machine</h2>

<p>In order to deploy content on a schedule, we need a server that is running at the times we want to deploy. If you have a physical server that fits this criterion, by all means use it! I did not have a server to spare so I chose a virtual machine schedule deployments.</p>

<h3 id="overview">Overview</h3>

<p>This is a fairly large step and there are a few gotchas, so let me speak generally about what we’re doing before diving into the details. We are creating a virtual environment where we can install all of the tools needed to checkout, build, and deploy our site at any time that we want. Ultimately we need to install Git, Ruby, Jekyll, NPM, Grunt, and Surge. Then we’ll clone our site and use cron to run our <code class="highlighter-rouge">grunt publish</code> command on a schedule.</p>

<h3 id="detailed-instructions">Detailed Instructions</h3>

<p>If you’re following these steps to the letter, then the next step is to create a <a href="https://www.digitalocean.com/" title="Digital Ocean: Cheap and Easy Virtual Machines">Digital Ocean</a> account. Then create a droplet using the $5 per month pricing tier (yes, this solution costs money), choose the “Ubuntu 15.10 x64” image, and pick a data center nearest to where your readers are located.</p>

<p><strong>GOTCHA #2:</strong> <em>If you use Digital Ocean for your VM, pay close attention to the IP address assigned to your VM. If it starts with “192.241.” then delete it and create a new one. Surge.sh is also hosted on Digital Ocean and Surge’s software prevents uploads from IP addresses on the same subnet as their own.</em></p>

<p>Follow these instructions to <a href="https://www.digitalocean.com/community/tutorials/how-to-use-ssh-keys-with-digitalocean-droplets" title="How To Use SSH Keys with DigitalOcean Droplets">Use SSH Keys with Digital Ocean Droplets</a>. Then SSH to your Droplet as the root user to run the rest of the commands in this article.</p>

<p>You should run the first set of commands as root to do things like install git, curl, libssl, and ntpdate.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Install git, curl, libssl, ntpdate, etc.</span>
root@vm <span class="nv">$ </span>apt-get update
root@vm <span class="nv">$ </span>apt-get install git curl build-essential libssl-dev ntpdate
</code></pre>
</div>

<p>I also recommend creating a dedicated user for performing your deployments, so let’s take care of that.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Create a user named "myuser" and set its password</span>
root@vm <span class="nv">$ </span>useradd -m myuser
root@vm <span class="nv">$ </span>passwd myuser

<span class="c"># Add user to sudoers file</span>
root@vm <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"myuser ALL=(ALL:ALL) ALL"</span> &gt;&gt; /etc/sudoers
</code></pre>
</div>

<p>Since we’re going to be scheduling time-sensitive content, let’s also adjust the time zone and run <code class="highlighter-rouge">ntpdate</code> occasionally so the time on the VM doesn’t drift over a long period of time.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Choose a time zone</span>
root@vm <span class="nv">$ </span>dpkg-reconfigure tzdata

<span class="c"># Run ntpdate daily</span>
root@vm <span class="nv">$ </span><span class="nb">printf</span> <span class="s1">'#!/bin/sh\nntpdate ntp.ubuntu.com\n'</span> &gt; /etc/cron.daily/ntpdate
</code></pre>
</div>

<p>All of the remaining commands should run as the user you created. If you are prompted for a password at any point, use the password you specified for “myuser”.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Switch to the user you created</span>
root@vm <span class="nv">$ </span>su - myuser
</code></pre>
</div>

<p>Now let’s install RVM, Ruby, and Bundler.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Install the public key needed to fetch RVM</span>
myuser@vm <span class="nv">$ </span>gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3

<span class="c"># Download and install RVM</span>
myuser@vm <span class="nv">$ </span>curl -L https://get.rvm.io | bash -s stable
myuser@vm <span class="nv">$ </span><span class="nb">source</span> ~/.rvm/scripts/rvm
myuser@vm <span class="nv">$ </span>rvm requirements

<span class="c"># Install and configure Ruby</span>
myuser@vm <span class="nv">$ </span>rvm install ruby
myuser@vm <span class="nv">$ </span>rvm use ruby --default
myuser@vm <span class="nv">$ </span>rvm rubygems current

<span class="c"># Install Bundler</span>
myuser@vm <span class="nv">$ </span>gem install bundler
</code></pre>
</div>

<p>Next up: NVM and Node.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Download and install NVM</span>
myuser@vm <span class="nv">$ </span>curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash
myuser@vm <span class="nv">$ </span>. ~/.nvm/nvm.sh

<span class="c"># Install Node 4.3.1, or whichever version you'd like</span>
myuser@vm <span class="nv">$ </span>nvm install 4.3.1
myuser@vm <span class="nv">$ </span>nvm use 4.3.1
</code></pre>
</div>

<p>That’s it for software installation on your droplet!</p>

<h2 id="step-3-clone-your-site">Step 3: Clone Your Site</h2>

<p>Use Git to clone your static site and install its dependencies:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Clone your static site from GitHub</span>
myuser@vm <span class="nv">$ </span>git clone https://github.com/my-user/my-site.com.git
myuser@vm <span class="nv">$ </span><span class="nb">cd </span>my-site.com

<span class="c"># Install Grunt and Surge</span>
myuser@vm <span class="nv">$ </span>npm install -g grunt-cli
myuser@vm <span class="nv">$ </span>npm install -g surge

<span class="c"># Install project dependencies</span>
myuser@vm <span class="nv">$ </span>bundle install
myuser@vm <span class="nv">$ </span>npm install
</code></pre>
</div>

<p>While we’re here, let’s log into Surge. Make sure you know your username and password.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Login to Surge</span>
myuser@vm <span class="nv">$ </span>surge login
</code></pre>
</div>

<p>This would be a good time to test deployments from the VM. This should do the trick:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Manually deploy your site</span>
myuser@vm <span class="nv">$ </span>/home/myuser/my-site.com/deploy.sh /home/myuser/my-site.com
</code></pre>
</div>

<p>Once everything deploys smoothly, we can schedule that script!</p>

<h2 id="step-4-schedule-deployments">Step 4: Schedule Deployments</h2>

<p>Use cron to run <code class="highlighter-rouge">deploy.sh</code> on a schedule. First, edit your user’s crontab:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c"># Edit your crontab</span>
myuser@vm <span class="nv">$ </span>crontab -e
</code></pre>
</div>

<p>Add the following two lines to the crontab. The first line is simply a comment to help remember the schedule. In the following example, the script will run every Wednesday at 12:30 AM in the time zone that you configured for the VM. Here’s a good <a href="http://code.tutsplus.com/tutorials/scheduling-tasks-with-cron-jobs--net-8800" title="Scheduling Tasks with Cron Jobs">intro to scheduling with cron</a>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code># Fetch blog content and deploy every Wednesday at 12:30 AM
30 0 * * 3 /home/myuser/my-site.com/deploy.sh prod /home/myuser/my-site.com/ &gt; /home/myuser/log/blog.log 2&gt;&amp;1
</code></pre>
</div>

<p>The command also writes all output to a log file. That way, if an error occurs, you can look at the output to determine what went wrong. If you run your deployments frequently, you may also want to put a timestamp on your log files.</p>

<p><strong>THAT’S IT!</strong> The deployments will start running on your schedule, freeing you from doing it by hand!</p>

<h2 id="alternatives">Alternatives</h2>

<p>Before writing my own solution, I tried to find something that already existed. There were a couple, but neither quite fit my needs. I’ve put them here just in case you might find them useful.</p>

<ol>
  <li>If you are using <a href="https://pages.github.com/" title="GitHub Pages: Free Static Site Hosting on GitHub">GitHub Pages</a> as your static site host, here’s a pretty clever solution that uses <a href="https://zapier.com/" title="Zapier: Automate Tasks">Zapier</a> and calendar events to avoid using a server or VM to schedule deployments. <br />
<a href="http://blog.east5th.co/2014/12/29/scheduling-posts-with-jekyll-github-pages-and-zapier/" title="Use Zapier to schedule deployments to GitHub Pages">http://blog.east5th.co/2014/12/29/scheduling-posts-with-jekyll-github-pages-and-zapier/</a></li>
  <li>This tutorial shows how to use <a href="http://rake.rubyforge.org/" title="Rake: A Build Program for Ruby Projects">Rake</a> to consolidate your deployments instead of Grunt. If I weren’t already using Grunt for my builds and manual deployments, I probably would have tried this.<br />
<a href="http://www.jaredwolff.com/blog/schedule-jekyll-posts/" title="Use Rake and Cron to schedule static site deployments">http://www.jaredwolff.com/blog/schedule-jekyll-posts/</a></li>
</ol>

<p><strong>Feature Request:</strong> Add scheduling to <a href="http://prose.io/" title="Prose: A Web-based Content Editor for GitHub">Prose</a>. It would be sooooper sweet if Prose could detect that you are editing content in a “gh-pages” branch and offer the option to defer pushes until a specific point in the future. This would remove the entire deployment process <em>and</em> you could write content from anywhere! Alas, the feature doesn’t exist.</p>

<h2 id="conclusion">Conclusion</h2>

<p>It takes a little bit of work, but creating a system where you can schedule static site content has lots of perks. And even though manually deploying may only take a couple of minutes each time, avoiding the context switch and being able to step away from your computer for days or weeks are worth the time to avoid repeating yourself day after day with the same mundane task.</p>

</section>
            <p class="signature"> - Erik</p>
        </article>
    </div>
</div>

    </div>
    <footer class="site-footer">
	<p class="text">Copyright © 2015 Technical Rex, Inc. Re-use with attribution encouraged. All other rights reserved.</p>
</footer>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-62666024-3', 'auto');
ga('send', 'pageview');
</script>



  </div>
  <img id="rex" src="/img/rex/rex-main.png"></img>
  <script type="text/javascript" src="/js/retarget-links.js"></script>
</body>
</html>
